# ms dos interrupt clock
![dos_interrupt_clock](https://raw.githubusercontent.com/commeta/dos_interrupt_clock/master/screen_shot.png "dos_interrupt_clock")

## Часы в правом верхнем углу экрана под MS DOS или FREE DOS
- Работают только в текстовом режиме
- Полностью фоновый режим работы под дос

- clock.exe - запуск резидентной копии
- clockoff.com - выгрузка резидентой копии из памяти

![dos_interrupt_clock](https://raw.githubusercontent.com/commeta/dos_interrupt_clock/master/screen_shot_over_dn.png "dos_interrupt_clock")
Copyright 1999 commeta <dcs-spb@ya.ru>


## CLOCK.ASM

Листинг для TASM, который воспроизведет оригинальную функциональность программы. Это программа-часы, которая перехватывает прерывание таймера и отображает время на экране.Этот восстановленный исходный код представляет собой программу-часы для MS-DOS, которая:

1. **Устанавливает обработчик прерывания таймера** (INT 1Ch) для отображения времени
2. **Проверяет состояние Scroll Lock** - часы отображаются только когда Scroll Lock включен
3. **Проверяет видеорежим** - работает только в текстовых режимах (0-3)
4. **Получает текущее время** через BIOS (INT 1Ah, функция 2)
5. **Преобразует время в формат ЧЧ:ММ:СС** для отображения
6. **Выводит время в верхней части экрана** в видеопамять (0xB800:0090)
7. **Остается резидентной в памяти** после завершения

Для компиляции используйте команды:
```
tasm clock.asm
tlink clock.obj
```

Программа будет работать как TSR (Terminate and Stay Resident) - после запуска останется в памяти и будет отображать часы в верхней части экрана при включенном Scroll Lock.


## CLOCKOFF.ASM

Листинг для TASM. Эта программа отключает системные часы в MS-DOS, манипулируя флагом клавиатуры в BIOS Data Area и освобождая память.Я создал восстановленный исходный код на основе дизассемблированного листинга. Программа выполняет следующие функции:

**Основные операции:**
1. Получает версию DOS (недокументированная функция)
2. Работает с векторами прерываний (получает вектор INT 61h и устанавливает INT 1Ch)
3. Модифицирует BIOS Data Area по адресу 0x417 (флаг состояния клавиатуры)
4. Освобождает блок памяти
5. Выводит код ошибки при неудаче или завершается успешно

**Для компиляции в TASM:**
```
TASM CLOCKOFF.ASM
TLINK /T CLOCKOFF.OBJ
```

Ключ `/T` создаст COM-файл вместо EXE. Программа предназначена для работы в среде MS-DOS и манипулирует системными ресурсами низкого уровня, включая BIOS Data Area и векторы прерываний.

**Примечание:** Эта программа выполняет системные операции низкого уровня и может влиять на работу системных часов и управление памятью в DOS.
